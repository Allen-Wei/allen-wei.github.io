<html>

<head>
    <title>ContentEditable</title>
    <script src="../../library/angularjs-v1.3.15/angular.js"></script>
    <style type="text/css">
    .container {
        height: 300px;
        width: 400px;
        border: 1px solid #0094ff;
    }
    </style>
</head>

<body ng-app="EditorApp">
    <div ng-controller="BodyCtrl as main">
        <div>
            <h3>Editable: </h3>
            <div class="container" contenteditable html="main.comment" editor></div>
        </div>
        <hr />
        <div>
            <h3>comment in BodyCtrl</h3>
            <textarea class="container" ng-model="main.comment"></textarea>
        </div>
    </div>
    <script>
    angular.module("EditorApp", [])
        .controller("BodyCtrl", function() {
            this.comment = "<b>hello</b> <i>world</i>.<hr /><h1>Please enter html under textaea.</h1>";
        })
        .directive("editor", function($timeout) {
            return {
                restrict: 'A', // only activate on element attribute
                scope: {
                    html: "="
                },
                link: function(scope, element, attrs) {

                    //element.html(scope.html);

                    element.on('blur keyup change', function() {
                        var html = element.html();
                        console.log(html);
                        $timeout(function() {
                            scope.html = html;
                        });
                    });

                    scope.$watch("html", function(newVal){
                    	element.html(newVal);
                    });
                }
            };
        });
    </script>
</body>

</html>
